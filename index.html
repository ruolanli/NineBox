<!DOCTYPE html>
<html lang="zh-CN">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover" />
<title>Day11 Â· 9è¯å›åˆè®­ç»ƒï½œè¯å¡ + ä¾‹å¥ + é”™é¢˜æœ¬</title>
<style>
  :root{
    /* â€”â€” ä¸»é¢˜ï¼šè°ƒäº®ï¼ˆå†°ç™½å¾®è“ï¼‰ â€”â€” */
    --bg:#f7faff;             /* èƒŒæ™¯ä¸»è‰²æ›´äº® */
    --bg2:#eaf2ff;
    --txt:#0f1a2e;            /* ä¸»æ–‡å­—æ”¹æ·±è‰² */
    --muted:#5c6a86;          /* æ¬¡çº§æ–‡å­— */
    --card:rgba(255,255,255,.86); /* ç»ç’ƒå¡æ›´äº® */
    --blur:10px;
    --stroke:rgba(22,34,66,.12);
    --accent:#4d7cff;         /* ç‚¹ç¼€è“ */
    --accent2:#86b2ff;        /* æ¬¡ç‚¹ç¼€ */
    --ok:#2fa66e;             /* æ­£å‘è‰² */
    --warn:#e6a900;           /* æç¤ºè‰² */
    --danger:#e05b72;         /* å±é™©è‰² */
  }
  html,body{height:100%}
  body{
    margin:0;
    background:
      radial-gradient(900px 55% at 20% -10%, #e6eeff 0%, transparent 60%),
      radial-gradient(900px 55% at 120% 30%, #f0f5ff 0%, transparent 50%),
      linear-gradient(180deg,var(--bg),var(--bg2));
    color:var(--txt);
    font:16px/1.5 -apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Helvetica,Arial,"Noto Sans SC","PingFang SC","Hiragino Sans GB",sans-serif;
  }
  .app{max-width:1000px;margin:0 auto;padding:20px 16px 28px}
  header.head{display:flex;gap:14px;align-items:center;justify-content:space-between;flex-wrap:wrap}
  .title{display:flex;align-items:center;gap:10px}
  .title h1{font-size:20px;margin:0;font-weight:700;letter-spacing:.3px}
  .badge{font-size:12px;padding:4px 8px;border:1px solid var(--stroke);border-radius:999px;background:rgba(255,255,255,.7);color:var(--muted)}
  .controls{display:flex;gap:8px;flex-wrap:wrap}
  .btn{
    appearance:none;border:1px solid var(--stroke);
    background:linear-gradient(180deg,rgba(255,255,255,1),rgba(255,255,255,.85));
    color:var(--txt);padding:8px 12px;border-radius:10px;font-size:14px;cursor:pointer;
    backdrop-filter:blur(var(--blur));transition:.2s;display:inline-flex;align-items:center;gap:8px
  }
  .btn:hover{transform:translateY(-1px);box-shadow:0 10px 24px -16px rgba(15,26,46,.25)}
  .btn[disabled]{opacity:.55;cursor:not-allowed}
  .btn.primary{border-color:rgba(77,124,255,.35);box-shadow:inset 0 0 0 1px rgba(77,124,255,.2)}
  .btn.ghost{background:transparent}

  .tabs{margin-top:14px;display:flex;gap:10px;flex-wrap:wrap}
  .tabs .tab{padding:6px 12px;border:1px solid var(--stroke);border-radius:999px;font-size:13px;color:var(--muted);cursor:pointer}
  .tabs .tab.active{color:var(--txt);border-color:rgba(77,124,255,.35);box-shadow:inset 0 0 0 1px rgba(77,124,255,.2)}

  /* ç½‘æ ¼å¡ç‰‡ */
  .grid{display:grid;grid-template-columns:repeat(3,1fr);gap:12px;margin-top:14px}
  @media (max-width:760px){.grid{grid-template-columns:repeat(2,1fr)}}
  @media (max-width:520px){.grid{grid-template-columns:1fr}}
  .card{
    position:relative;padding:16px;border-radius:16px;
    background:var(--card);
    border:1px solid var(--stroke);
    backdrop-filter:blur(var(--blur));min-height:120px;display:flex;flex-direction:column;gap:8px
  }
  .term{font-size:22px;font-weight:800;letter-spacing:.2px;margin:6px 0} /* â†‘ ç¨å¾®æ”¾å¤§ */
  .cn{color:var(--ok);font-size:18px;display:none}                       /* â†‘ ç¨å¾®æ”¾å¤§ */
  .cn.show{display:block}
  .meta{font-size:12px;color:var(--muted)}
  .toolbar{position:absolute;top:8px;right:8px;display:flex;gap:6px}
  .iconbtn{
    border:1px solid var(--stroke);background:rgba(255,255,255,.9);
    width:34px;height:32px;border-radius:9px;display:grid;place-items:center;
    color:#5a6b85;cursor:pointer
  }
  .iconbtn.active{color:var(--accent);box-shadow:inset 0 0 0 1px rgba(77,124,255,.35)}
  .iconbtn:hover{transform:translateY(-1px)}

  /* ä¾‹å¥åŒºåŸŸ */
  .sentences{display:grid;grid-template-columns:1fr;gap:12px;margin-top:12px}
  .sentence{
    padding:16px 16px;border-radius:14px;background:var(--card);
    border:1px solid var(--stroke);backdrop-filter:blur(var(--blur));
  }
  .en{font-weight:700}
  .zh{display:none;color:var(--ok)}
  .zh.show{display:block;margin-top:6px}

  footer.foot{margin-top:16px;display:flex;gap:10px;align-items:center;justify-content:space-between;color:var(--muted)}
  .meter{height:8px;background:rgba(15,26,46,.07);border-radius:999px;overflow:hidden;flex:1}
  .bar{height:100%;background:linear-gradient(90deg,var(--accent),var(--accent2));width:0%}

  /* æ¨¡æ€å±‚ */
  .modal{position:fixed;inset:0;display:none;place-items:center;background:rgba(10,12,20,.25);backdrop-filter:blur(6px);z-index:40}
  .modal.show{display:grid}
  .dialog{
    width:min(720px,92vw);
    background:linear-gradient(180deg,rgba(255,255,255,1),rgba(255,255,255,.92));
    border:1px solid var(--stroke);border-radius:16px;padding:18px;color:var(--txt)
  }

  /* è¿·ä½ å½©çº¸ */
  .burst{position:fixed;pointer-events:none;inset:0;overflow:hidden;z-index:60}
  .piece{position:absolute;width:8px;height:12px;opacity:0;animation:pop 1s ease-out forwards}
  @keyframes pop{0%{transform:translate(var(--x),var(--y)) rotate(0) scale(.8);opacity:1}
                 100%{transform:translate(var(--x2),var(--y2)) rotate(720deg) scale(1);opacity:0}}

  .hint{font-size:12px;color:var(--muted)}
</style>
</head>
<body>
  <div class="app">
    <header class="head">
      <div class="title" id="title">
        <span class="badge">Day11</span>
        <h1>9è¯å›åˆè®­ç»ƒ Â· è¯å¡ â†” ä¾‹å¥ Â· é”™é¢˜æœ¬</h1>
      </div>
      <div class="controls">
        <button class="btn" id="prevBtn">â† ä¸Šä¸€å›åˆ</button>
        <button class="btn primary" id="toggleViewBtn">åˆ‡æ¢åˆ°ä¾‹å¥é¡µ</button>
        <button class="btn" id="nextBtn">ä¸‹ä¸€å›åˆ â†’</button>
        <button class="btn ghost" id="showAllBtn">æ˜¾ç¤ºå…¨éƒ¨è¯‘æ–‡</button>
        <button class="btn ghost" id="hideAllBtn">éšè—å…¨éƒ¨è¯‘æ–‡</button>
        <button class="btn" id="shuffleBtn">éšæœºé¡ºåº</button>
        <button class="btn" id="wrongTabBtn">é”™é¢˜æœ¬</button>
        <button class="btn" id="deckTabBtn" style="display:none">è¿”å›è¯åº“</button>
        <button class="btn" id="miniGameBtn">ğŸ® ç¿»è¯‘æŒ‘æˆ˜</button>
        <button class="btn ghost" id="eggBtn" title="å°æƒŠå–œ">ğŸ</button>
      </div>
      <div class="hint">æç¤ºï¼šç‚¹å‡»å•è¯å³å¯<span style="color:var(--ok)">å‘éŸ³ + æ˜¾ç¤ºç¿»è¯‘</span>ï¼›ğŸ“Œå›¾é’‰åŠ å…¥é”™é¢˜æœ¬ï¼›ğŸ’¬æŸ¥çœ‹ä¾‹å¥ã€‚</div>
    </header>

    <section id="wordsView">
      <div class="grid" id="grid"></div>
    </section>

    <section id="sentencesView" style="display:none">
      <div class="controls" style="margin-top:4px">
        <button class="btn" id="shuffleSentBtn">æ¢ä¸€ç»„ä¾‹å¥</button>
        <button class="btn ghost" id="showAllZhSent">æ˜¾ç¤ºå…¨éƒ¨è¯‘æ–‡</button>
        <button class="btn ghost" id="hideAllZhSent">éšè—å…¨éƒ¨è¯‘æ–‡</button>
      </div>
      <div class="sentences" id="sentences"></div>
    </section>

    <footer class="foot">
      <div id="status">å›åˆ <span id="roundIdx">1</span>/<span id="roundTotal">1</span> Â· æœ¬å›åˆè¯æ•° <span id="roundCount">0</span> Â· é”™é¢˜æœ¬ <span id="wrongCount">0</span></div>
      <div class="meter"><div class="bar" id="bar"></div></div>
    </footer>
  </div>

  <!-- ä¾‹å¥å¼¹çª— -->
  <div class="modal" id="exampleModal" aria-hidden="true">
    <div class="dialog">
      <div style="display:flex;justify-content:space-between;align-items:center;gap:8px">
        <h3 id="exTitle" style="margin:0">ä¾‹å¥</h3>
        <button class="btn" id="closeEx">å…³é—­</button>
      </div>
      <div style="margin-top:10px" id="exContent"></div>
    </div>
  </div>

  <!-- è¿·ä½ æŒ‘æˆ˜å¼¹çª—ï¼ˆé€šç”¨ï¼Œç”¨äºæ­£å¸¸æŒ‘æˆ˜ + å¶é‡æµ‹éªŒï¼‰ -->
  <div class="modal" id="quizModal" aria-hidden="true">
    <div class="dialog">
      <div style="display:flex;justify-content:space-between;align-items:center;gap:8px">
        <h3 id="quizTitle" style="margin:0">ğŸ¯ ç¿»è¯‘æŒ‘æˆ˜ï¼ˆè¾“å…¥ä¸­æ–‡ä¹‰ï¼‰</h3>
        <button class="btn" id="closeQuiz">å…³é—­</button>
      </div>
      <div id="quizWrap" style="margin-top:12px"></div>
    </div>
  </div>

  <div class="burst" id="burst"></div>

<script>
/* â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ æ•°æ®ï¼šæ–°è¯åº“ï¼ˆå”¯ä¸€è¯æ¡ï¼‰ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
/* åªå†™è¯å’Œä¸­æ–‡ä¹‰ï¼›ä¾‹å¥ç”±ç”Ÿæˆå™¨åŠ¨æ€æ‹¼å‡ºï¼Œå¹¶ä¸”æ¯å¥è‡ªåŠ¨å¤¹å¸¦ 3 ä¸ªåŒè¡¨è¯æ±‡ */
const base = [
  {t:'consequence', cn:'åæœï¼›ç»“æœ', ex:[
    'Your choice has a consequence: despite the risks, you propose an expansion that may not make sense.',
    'ä½ çš„é€‰æ‹©ä¼šå¸¦æ¥åæœï¼šå°½ç®¡æœ‰é£é™©ï¼Œä½ ä»æè®®æ‰©å¼ ï¼Œè€Œè¿™æœªå¿…è®²å¾—é€šã€‚'
  ]},
  {t:'instead', cn:'ä»£æ›¿ï¼›åè€Œ', ex:[
    'Instead of a long presentation, we select a brief drill to assess the teamâ€™s response.',
    'æˆ‘ä»¬ä¸åšå†—é•¿æ±‡æŠ¥ï¼Œæ”¹ä¸ºé€‰æ‹©ä¸€æ¬¡ç®€çŸ­æ¼”ç»ƒæ¥è¯„ä¼°å›¢é˜Ÿçš„ååº”ã€‚'
  ]},
  {t:'besides', cn:'æ­¤å¤–ï¼›é™¤â€¦ä¹‹å¤–', ex:[
    'Besides the ceremony, the plan includes a memorial visit and an appointment to consult a native guide.',
    'é™¤ä»ªå¼å¤–ï¼Œè®¡åˆ’è¿˜åŒ…å«å‚è§‚çºªå¿µç¢‘ä»¥åŠé¢„çº¦å’¨è¯¢æœ¬åœ°å‘å¯¼ã€‚'
  ]},
  {t:'moreover', cn:'è€Œä¸”ï¼›æ­¤å¤–', ex:[
    'Moreover, the assistant will confirm your position and assign a female speaker for the presentation.',
    'è€Œä¸”ï¼ŒåŠ©ç†ä¼šç¡®è®¤ä½ çš„åº§ä½ï¼Œå¹¶ä¸ºæ±‡æŠ¥æŒ‡æ´¾ä¸€ä½å¥³è®²è€…ã€‚'
  ]},
  {t:'choice', cn:'é€‰æ‹©', ex:[
    'Her choice to retire was responsible and made sense despite the desire for expansion.',
    'å°½ç®¡ä»æ¸´æœ›æ‰©å¼ ï¼Œå¥¹é€‰æ‹©é€€ä¼‘æ˜¯è´Ÿè´£ä»»ä¸”åˆä¹æƒ…ç†çš„ã€‚'
  ]},
  {t:'response', cn:'å›åº”ï¼›ååº”', ex:[
    'The response was amazing; the board approve the expansion and propose to integrate a wider range.',
    'åé¦ˆå¾ˆäº®çœ¼ï¼›è‘£äº‹ä¼šæ‰¹å‡†äº†æ‰©å¼ ï¼Œå¹¶æè®®æ•´åˆæ›´å¹¿çš„èŒƒå›´ã€‚'
  ]},
  {t:'previous', cn:'å…ˆå‰çš„', ex:[
    'The previous assess report did not observe the contrast in appetite across the age range.',
    'å…ˆå‰çš„è¯„ä¼°æŠ¥å‘Šæœªè§‚å¯Ÿåˆ°ä¸åŒå¹´é¾„æ®µåœ¨â€œåå¥½â€ä¸Šçš„å·®å¼‚ã€‚'
  ]},
  {t:'wheel', cn:'è½®å­ï¼›è½¦è½®', ex:[
    'Without a front wheel, the hunt truck lost balance at the edge of the muddy setting.',
    'æ²¡æœ‰å‰è½®ï¼Œç‹©çŒç”¨å¡è½¦åœ¨æ³¥æ³ç¯å¢ƒçš„è¾¹ç¼˜å¤±å»å¹³è¡¡ã€‚'
  ]},
  {t:'harvest', cn:'æ”¶è·ï¼›æ”¶å‰²', ex:[
    'The harvest festival ceremony will involve a native dance and a presentation by the assistant.',
    'ä¸°æ”¶èŠ‚çš„ä»ªå¼ä¼šåŒ…å«æœ¬åœ°èˆè¹ˆï¼Œä»¥åŠåŠ©ç†å¸¦æ¥çš„å±•ç¤ºã€‚'
  ]},
  {t:'ceremony', cn:'ä»ªå¼', ex:[
    'At the ceremony, we observe a silence by the memorial and confirm the schedule.',
    'åœ¨ä»ªå¼ä¸Šï¼Œæˆ‘ä»¬åœ¨çºªå¿µç¢‘å‰é»˜å“€ï¼Œå¹¶ç¡®è®¤åç»­æ—¥ç¨‹ã€‚'
  ]},
  {t:'drill', cn:'è®­ç»ƒï¼›æ¼”ç»ƒï¼›é’»', ex:[
    'The safety drill will require students to concentrate, select exits, and follow the assistantâ€™s position signs.',
    'å®‰å…¨æ¼”ç»ƒè¦æ±‚å­¦ç”Ÿä¸“æ³¨ã€é€‰æ‹©å‡ºå£ï¼Œå¹¶è·ŸéšåŠ©ç†çš„æŒ‡ç¤ºç‰Œã€‚'
  ]},
  {t:'hunt', cn:'ç‹©çŒï¼›æœå¯»', ex:[
    'They hunt for evidence beyond the previous figure to evaluate the contrast in results.',
    'ä»–ä»¬å¯»æ‰¾è¶…å‡ºå…ˆå‰æ•°æ®çš„è¯æ®ï¼Œä»¥è¯„ä¼°ç»“æœçš„å·®å¼‚ã€‚'
  ]},
  {t:'observe', cn:'è§‚å¯Ÿï¼›éµå®ˆ', ex:[
    'We observe that independent learners tend to consult early and settle problems instead of delaying.',
    'æˆ‘ä»¬è§‚å¯Ÿåˆ°ç‹¬ç«‹å‹å­¦ä¹ è€…æ›´å€¾å‘äºå°½æ—©è¯·æ•™å¹¶è§£å†³é—®é¢˜ï¼Œè€Œéæ‹–å»¶ã€‚'
  ]},
  {t:'essential', cn:'å¿…è¦çš„ï¼›æœ¬è´¨çš„', ex:[
    'Regular measure of progress is essential to approve budgets and prevent risky expansion.',
    'å®šæœŸé‡åŒ–è¿›åº¦æ˜¯å¿…è¦çš„ï¼Œè¿™æœ‰åŠ©äºæ‰¹å‡†é¢„ç®—å¹¶é¿å…é«˜é£é™©æ‰©å¼ ã€‚'
  ]},
  {t:'assistant', cn:'åŠ©æ‰‹ï¼›åŠ©ç†', ex:[
    'The assistant will assign seats, confirm appointments, and integrate late arrivals into the ceremony.',
    'åŠ©ç†ä¼šåˆ†é…åº§ä½ã€ç¡®è®¤é¢„çº¦ï¼Œå¹¶æŠŠè¿Ÿåˆ°è€…èå…¥åˆ°ä»ªå¼æµç¨‹ä¸­ã€‚'
  ]},
  {t:'female', cn:'å¥³æ€§çš„ï¼›é›Œæ€§', ex:[
    'The female engineer evaluate options and propose a balanced range of solutions.',
    'è¿™ä½å¥³å·¥ç¨‹å¸ˆè¯„ä¼°äº†å¤šç§æ–¹æ¡ˆï¼Œå¹¶æå‡ºäº†å…¼é¡¾å¹³è¡¡çš„è§£æ³•èŒƒå›´ã€‚'
  ]},
  {t:'native', cn:'æœ¬åœ°çš„ï¼›æ¯è¯­çš„', ex:[
    'A native speaker will consult students, assess pronunciation, and select particular drills.',
    'ä¸€ä½æ¯è¯­è€…å°†ä¸ºå­¦ç”Ÿæä¾›å’¨è¯¢ã€è¯„ä¼°å‘éŸ³ï¼Œå¹¶é€‰æ‹©é’ˆå¯¹æ€§çš„ç»ƒä¹ ã€‚'
  ]},
  {t:'instance', cn:'å®ä¾‹ï¼›ä¾‹å­', ex:[
    'For instance, a presentation may involve contrast and require the speaker to observe time limits.',
    'ä¾‹å¦‚ï¼Œä¸€åœºæŠ¥å‘Šå¯èƒ½æ¶‰åŠå¯¹æ¯”ï¼Œå¹¶è¦æ±‚è®²è€…éµå®ˆæ—¶é—´é™åˆ¶ã€‚'
  ]},
  {t:'attach', cn:'é™„ä¸Šï¼›é™„ç€ï¼›ç³»ä¸Š', ex:[
    'Please attach your assess form and confirm the appointment before the presentation.',
    'è¯·åœ¨æ±‡æŠ¥å‰é™„ä¸Šè¯„ä¼°è¡¨å¹¶ç¡®è®¤é¢„çº¦æ—¶é—´ã€‚'
  ]},
  {t:'struggle', cn:'æŒ£æ‰ï¼›æ–—äº‰', ex:[
    'They struggle to make sense of the figure, so they consult the assistant and settle on a new measure.',
    'ä»–ä»¬éš¾ä»¥ç†è§£è¿™ç»„æ•°æ®ï¼Œäºæ˜¯è¯·æ•™åŠ©ç†ï¼Œå¹¶æœ€ç»ˆç¡®å®šäº†æ–°çš„åº¦é‡æ–¹å¼ã€‚'
  ]},
  {t:'responsible', cn:'è´Ÿè´£çš„ï¼›æœ‰è´£ä»»çš„', ex:[
    'A responsible manager will evaluate risk, prevent scope creep, and assign clear positions.',
    'è´Ÿè´£ä»»çš„ç»ç†ä¼šè¯„ä¼°é£é™©ã€é¿å…èŒƒå›´è†¨èƒ€ï¼Œå¹¶æ¸…æ™°åˆ†é…èŒè´£ã€‚'
  ]},

  {t:'content', cn:'å†…å®¹ï¼›ï¼ˆadj.ï¼‰æ»¡æ„çš„', ex:[
    'The content contrasts previous claims and will require expansion to integrate the new data.',
    'è¿™äº›å†…å®¹ä¸å…ˆå‰ç»“è®ºå½¢æˆå¯¹æ¯”ï¼Œéœ€è¦æ‰©å±•ä»¥æ•´åˆæ–°æ•°æ®ã€‚'
  ]},
  {t:'tend', cn:'å€¾å‘äºï¼›ç…§æ–™', ex:[
    'Teams tend to approve small changes, but when leaders propose expansion beyond the normal range, they hesitate.',
    'å›¢é˜Ÿå€¾å‘äºæ‰¹å‡†å°æ”¹åŠ¨ï¼Œä½†å½“é¢†å¯¼æè®®è¶…å‡ºå¸¸è§„èŒƒå›´çš„æ‰©å¼ æ—¶ï¼Œä»–ä»¬ä¼šçŠ¹è±«ã€‚'
  ]},
  {t:'prevent', cn:'é˜²æ­¢ï¼›é˜»æ­¢', ex:[
    'Clear directions and early consult can prevent confusion and make sense to everyone involved.',
    'æ¸…æ™°æŒ‡ç¤ºä¸å°½æ—©è¯·æ•™èƒ½é˜²æ­¢æ··ä¹±ï¼Œå¹¶è®©æ‰€æœ‰å‚ä¸è€…è§‰å¾—åˆç†ã€‚'
  ]},
  {t:'presentation', cn:'æ¼”ç¤ºï¼›æŠ¥å‘Š', ex:[
    'Her presentation contrasts two settings, evaluate risks, and propose a responsible position.',
    'å¥¹çš„æŠ¥å‘Šå¯¹æ¯”äº†ä¸¤ç§æƒ…å¢ƒï¼Œè¯„ä¼°äº†é£é™©ï¼Œå¹¶æå‡ºäº†è´Ÿè´£çš„ç«‹åœºã€‚'
  ]},
  {t:'affection', cn:'å–œçˆ±ï¼›æ„Ÿæƒ…', ex:[
    'Out of affection and respect, they built a memorial and observed a quiet ceremony.',
    'å‡ºäºæ„Ÿæƒ…ä¸å°Šé‡ï¼Œä»–ä»¬å»ºèµ·äº†çºªå¿µç¢‘ï¼Œå¹¶ä¸¾è¡Œäº†å®‰é™çš„ä»ªå¼ã€‚'
  ]},
  {t:'respect', cn:'å°Šé‡ï¼›æ–¹é¢', ex:[
    'We respect the assistantâ€™s position and will confirm appointments instead of cutting the line.',
    'æˆ‘ä»¬å°Šé‡åŠ©ç†çš„å®‰æ’ï¼Œä¼šç¡®è®¤é¢„çº¦è€Œä¸æ˜¯æ’é˜Ÿã€‚'
  ]},
  {t:'figure', cn:'æ•°å­—ï¼›äººç‰©ï¼›èº«æï¼›è®¤ä¸º', ex:[
    'The latest figure suggests expansion; moreover, assess teams approve the plan after a drill.',
    'æœ€æ–°æ•°æ®æŒ‡å‘æ‰©å¼ ï¼›è€Œä¸”ï¼Œè¯„å®¡å°ç»„åœ¨æ¼”ç»ƒåæ‰¹å‡†äº†æ–¹æ¡ˆã€‚'
  ]},
  {t:'pose', cn:'é€ æˆï¼›æ‘†å§¿åŠ¿', ex:[
    'The policy may pose a risk to balance and require leaders to evaluate and consult.',
    'è¯¥æ”¿ç­–å¯èƒ½å¯¹å¹³è¡¡é€ æˆé£é™©ï¼Œéœ€è¦é¢†å¯¼å±‚è¯„ä¼°å¹¶è¯·æ•™ä¸“å®¶ã€‚'
  ]},
  {t:'desire', cn:'æ¸´æœ›ï¼›æ¬²æœ›', ex:[
    'Her desire to be independent led her to select a particular course range beyond the normal track.',
    'å¥¹æ¸´æœ›ç‹¬ç«‹ï¼Œå› æ­¤é€‰æ‹©äº†è¶…å‡ºå¸¸è§„è·¯å¾„çš„ç‰¹å®šè¯¾ç¨‹èŒƒå›´ã€‚'
  ]},

  {t:'persuade', cn:'è¯´æœ', ex:[
    'We tried to persuade the board to approve expansion by presenting clear measures and contrast.',
    'æˆ‘ä»¬é€šè¿‡å±•ç¤ºæ¸…æ™°çš„æªæ–½ä¸å¯¹æ¯”æ¥è®¾æ³•è¯´æœè‘£äº‹ä¼šæ‰¹å‡†æ‰©å¼ ã€‚'
  ]},
  {t:'memorial', cn:'çºªå¿µç¢‘ï¼›çºªå¿µé¦†', ex:[
    'The city built a memorial to native heroes and held a ceremony that involved students.',
    'åŸå¸‚ä¸ºæœ¬åœ°è‹±é›„å»ºèµ·çºªå¿µç¢‘ï¼Œå¹¶ä¸¾è¡Œäº†åŒ…å«å­¦ç”Ÿå‚ä¸çš„ä»ªå¼ã€‚'
  ]},
  {t:'settle', cn:'è§£å†³ï¼›å®‰é¡¿', ex:[
    'They settle the dispute by consulting experts, evaluating options, and confirming the final position.',
    'ä»–ä»¬é€šè¿‡å’¨è¯¢ä¸“å®¶ã€è¯„ä¼°é€‰é¡¹å¹¶ç¡®è®¤æœ€ç»ˆç«‹åœºæ¥è§£å†³äº‰ç«¯ã€‚'
  ]},
  {t:'involve', cn:'æ¶‰åŠï¼›ç‰µæ¶‰', ex:[
    'The project will involve an assistant team to integrate tools and assign responsible roles.',
    'è¯¥é¡¹ç›®å°†æ¶‰åŠä¸€æ”¯åŠ©ç†å›¢é˜Ÿï¼Œç”¨äºæ•´åˆå·¥å…·å¹¶åˆ†é…è´£ä»»è§’è‰²ã€‚'
  ]},
  {t:'appetite', cn:'é£Ÿæ¬²ï¼›æ¸´æœ›', ex:[
    'Appetite for risk is beyond normal this quarter; the board will assess and balance expansion.',
    'æœ¬å­£åº¦çš„é£é™©åå¥½é«˜äºå¸¸æ€ï¼›è‘£äº‹ä¼šå°†è¯„ä¼°å¹¶å¹³è¡¡æ‰©å¼ ã€‚'
  ]},
  {t:'measure', cn:'æµ‹é‡ï¼›æªæ–½', ex:[
    'We measure outcomes, contrast them with previous data, and make sense of the consequence.',
    'æˆ‘ä»¬åº¦é‡ç»“æœï¼Œä¸å…ˆå‰æ•°æ®åšå¯¹æ¯”ï¼Œå¹¶ç†è§£å…¶åæœã€‚'
  ]},
  {t:'setting', cn:'ç¯å¢ƒï¼›è®¾ç½®', ex:[
    'In a clinical setting, researchers observe responses, evaluate range, and prevent bias.',
    'åœ¨ä¸´åºŠç¯å¢ƒä¸­ï¼Œç ”ç©¶è€…ä¼šè§‚å¯Ÿååº”ã€è¯„ä¼°èŒƒå›´å¹¶é˜²æ­¢åå·®ã€‚'
  ]},
  {t:'select', cn:'é€‰æ‹©', ex:[
    'Please select a female speaker for the ceremony and confirm the appointment with the assistant.',
    'è¯·ä¸ºä»ªå¼é€‰æ‹©ä¸€ä½å¥³è®²è€…ï¼Œå¹¶ä¸åŠ©ç†ç¡®è®¤é¢„çº¦ã€‚'
  ]},
  {t:'contrast', cn:'å¯¹æ¯”ï¼›å·®å¼‚', ex:[
    'The contrast between content and response helps evaluate whether the plan makes sense.',
    'å†…å®¹ä¸åé¦ˆä¹‹é—´çš„å¯¹æ¯”æœ‰åŠ©äºè¯„ä¼°æ–¹æ¡ˆæ˜¯å¦åˆç†ã€‚'
  ]},

  {t:'integrate', cn:'æ•´åˆï¼›èå…¥', ex:[
    'We integrate the new wheel sensor to assess balance and improve beyond the previous range.',
    'æˆ‘ä»¬æ•´åˆäº†æ–°çš„è½¦è½®ä¼ æ„Ÿå™¨ï¼Œä»¥è¯„ä¼°å¹³è¡¡å¹¶è¶…è¶Šå…ˆå‰èŒƒå›´ã€‚'
  ]},
  {t:'approve', cn:'æ‰¹å‡†ï¼›èµæˆ', ex:[
    'The committee will approve expansion if you attach the measure plan and confirm the budget.',
    'è‹¥ä½ é™„ä¸Šæªæ–½æ–¹æ¡ˆå¹¶ç¡®è®¤é¢„ç®—ï¼Œå§”å‘˜ä¼šå°†æ‰¹å‡†æ‰©å¼ ã€‚'
  ]},
  {t:'expansion', cn:'æ‰©å±•ï¼›æ‰©å»º', ex:[
    'Rapid expansion can pose risks; therefore, we require independent assess and consult before approval.',
    'å¿«é€Ÿæ‰©å¼ ä¼šå¸¦æ¥é£é™©ï¼›å› æ­¤åœ¨æ‰¹å‡†å‰æˆ‘ä»¬éœ€è¦ç‹¬ç«‹è¯„ä¼°ä¸å’¨è¯¢ã€‚'
  ]},
  {t:'independent', cn:'ç‹¬ç«‹çš„', ex:[
    'An independent assistant can evaluate options, select a choice, and settle conflicts.',
    'ç‹¬ç«‹çš„åŠ©ç†èƒ½è¯„ä¼°é€‰é¡¹ã€ä½œå‡ºé€‰æ‹©å¹¶è§£å†³å†²çªã€‚'
  ]},
  {t:'assign', cn:'åˆ†é…ï¼›å¸ƒç½®', ex:[
    'We assign roles, integrate tools, and observe whether the workflow makes sense in this setting.',
    'æˆ‘ä»¬åˆ†é…è§’è‰²ã€æ•´åˆå·¥å…·ï¼Œå¹¶è§‚å¯Ÿè¯¥æµç¨‹åœ¨æ­¤æƒ…å¢ƒä¸‹æ˜¯å¦åˆç†ã€‚'
  ]},
  {t:'make sense', cn:'æœ‰é“ç†ï¼›è®²å¾—é€š', ex:[
    'It makes sense to consult native experts and evaluate contrast before you propose changes.',
    'åœ¨ä½ æå‡ºæ”¹åŠ¨å‰ï¼Œå‘æœ¬åœ°ä¸“å®¶è¯·æ•™å¹¶è¯„ä¼°å·®å¼‚æ˜¯æœ‰é“ç†çš„ã€‚'
  ]},
  {t:'confirm', cn:'ç¡®è®¤', ex:[
    'Please confirm your appointment, attach the presentation file, and select a position near the edge.',
    'è¯·ç¡®è®¤é¢„çº¦ã€é™„ä¸Šæ±‡æŠ¥æ–‡ä»¶ï¼Œå¹¶é€‰æ‹©é è¿‘è¾¹ç¼˜çš„ä½ç½®ã€‚'
  ]},
  {t:'fortunate', cn:'å¹¸è¿çš„', ex:[
    'We were fortunate to harvest early data; moreover, the response was amazing across a wide range.',
    'æˆ‘ä»¬å¾ˆå¹¸è¿åœ°æ—©æ—©æ”¶è·æ•°æ®ï¼›è€Œä¸”ï¼Œåé¦ˆåœ¨å¹¿æ³›èŒƒå›´å†…éƒ½å¾ˆå‡ºè‰²ã€‚'
  ]},
  {t:'evaluate', cn:'è¯„ä¼°ï¼›è¯„ä»·', ex:[
    'We evaluate the consequence of each choice and, if necessary, propose a safer alternative.',
    'æˆ‘ä»¬è¯„ä¼°æ¯ä¸ªé€‰æ‹©çš„åæœï¼Œå¿…è¦æ—¶æå‡ºæ›´å®‰å…¨çš„æ›¿ä»£æ–¹æ¡ˆã€‚'
  ]},

  {t:'require', cn:'éœ€è¦ï¼›è¦æ±‚', ex:[
    'Some drills require you to concentrate; besides, the setting may involve edge cases that make sense later.',
    'æœ‰äº›æ¼”ç»ƒéœ€è¦ä½ ä¸“æ³¨ï¼›æ­¤å¤–ï¼Œè¯¥æƒ…å¢ƒå¯èƒ½åŒ…å«ç¨åæ‰çœ‹å¾—æ‡‚çš„è¾¹ç¼˜æƒ…å†µã€‚'
  ]},
  {t:'despite', cn:'å°½ç®¡', ex:[
    'Despite the struggle, the team integrate systems and approve a balanced position.',
    'å°½ç®¡è‰°éš¾ï¼Œå›¢é˜Ÿè¿˜æ˜¯æ•´åˆäº†ç³»ç»Ÿï¼Œå¹¶æ‰¹å‡†äº†è¾ƒä¸ºå¹³è¡¡çš„ç«‹åœºã€‚'
  ]},
  {t:'propose', cn:'æè®®ï¼›æ±‚å©š', ex:[
    'They propose an appointment schedule to prevent overlap and respect everyoneâ€™s range of needs.',
    'ä»–ä»¬æè®®äº†ä¸€ä»½é¢„çº¦æ—¶é—´è¡¨ï¼Œä»¥é˜²å†²çªå¹¶å°Šé‡æ¯ä¸ªäººçš„éœ€æ±‚èŒƒå›´ã€‚'
  ]},
  {t:'consult', cn:'å’¨è¯¢ï¼›è¯·æ•™', ex:[
    'Consult the previous assess report and confirm whether expansion is still responsible.',
    'è¯·æŸ¥é˜…å…ˆå‰çš„è¯„ä¼°æŠ¥å‘Šï¼Œå¹¶ç¡®è®¤æ‰©å¼ æ˜¯å¦ä»å±è´Ÿè´£ä¹‹ä¸¾ã€‚'
  ]},
  {t:'position', cn:'ä½ç½®ï¼›èŒä½ï¼›ç«‹åœº', ex:[
    'Her position went beyond normal; to persuade the board, she propose we attach strict measure before they approve.',
    'å¥¹çš„ç«‹åœºè¶…å‡ºäº†å¸¸è§„ï¼›ä¸ºè¯´æœè‘£äº‹ä¼šï¼Œå¥¹æè®®åœ¨æ‰¹å‡†å‰é™„åŠ ä¸¥æ ¼çš„æªæ–½ã€‚'
  ]},

  {t:'amazing', cn:'ä»¤äººæƒŠå¹çš„', ex:[
    'The museumâ€™s collection is amazing; moreover, native guides select particular pieces to make sense of the era.',
    'åšç‰©é¦†çš„è—å“ä»¤äººæƒŠå¹ï¼›è€Œä¸”ï¼Œæœ¬åœ°è®²è§£å‘˜é€‰æ‹©äº†ç‰¹å®šå±•å“æ¥è®²æ¸…é‚£ä¸ªæ—¶ä»£ã€‚'
  ]},
  {t:'collection', cn:'æ”¶è—ï¼›åˆé›†', ex:[
    'Our collection will expand beyond the edge of the current range if the committee approve.',
    'è‹¥å§”å‘˜ä¼šåŒæ„ï¼Œæˆ‘ä»¬çš„è—å“å°†æ‰©å±•åˆ°ç°æœ‰èŒƒå›´çš„å¤–ç¼˜ã€‚'
  ]},
  {t:'balance', cn:'å¹³è¡¡ï¼›æƒè¡¡', ex:[
    'To balance appetite and risk, leaders evaluate data and consult independent experts.',
    'ä¸ºæƒè¡¡åå¥½ä¸é£é™©ï¼Œç®¡ç†å±‚è¯„ä¼°æ•°æ®å¹¶å’¨è¯¢ç‹¬ç«‹ä¸“å®¶ã€‚'
  ]},
  {t:'range', cn:'èŒƒå›´ï¼›å¹…åº¦', ex:[
    'The product range will integrate new features and require careful presentation to persuade users.',
    'è¯¥äº§å“çº¿å°†æ•´åˆæ–°ç‰¹æ€§ï¼Œå¹¶éœ€è¦è°¨æ…å±•ç¤ºæ¥æ‰“åŠ¨ç”¨æˆ·ã€‚'
  ]},
  {t:'retire', cn:'é€€ä¼‘ï¼›é€€å‡º', ex:[
    'He plans to retire; instead, the assistant will assume the position and assign tasks.',
    'ä»–æ‰“ç®—é€€ä¼‘ï¼›ç”±åŠ©ç†æ¥ä»»å²—ä½å¹¶åˆ†é…ä»»åŠ¡ã€‚'
  ]},
  {t:'normal', cn:'æ­£å¸¸çš„', ex:[
    'Under normal conditions we observe, a brief drill can prevent panic and make sense to students.',
    'åœ¨æˆ‘ä»¬è§‚å¯Ÿåˆ°çš„å¸¸è§„æ¡ä»¶ä¸‹ï¼Œç®€çŸ­æ¼”ç»ƒå°±èƒ½é˜²æ­¢ææ…Œä¸”å¯¹å­¦ç”Ÿæ˜¯åˆç†çš„ã€‚'
  ]},
  {t:'beyond', cn:'è¶…å‡ºï¼›åœ¨â€¦ä¹‹å¤–', ex:[
    'Beyond the ceremony, the schedule includes a memorial visit and a presentation to approve funding.',
    'é™¤äº†ä»ªå¼ï¼Œæ—¥ç¨‹è¿˜åŒ…æ‹¬å‚è§‚çºªå¿µç¢‘ä»¥åŠä¸€åœºä¸ºäº‰å–ç»è´¹æ‰¹å‡†çš„æ±‡æŠ¥ã€‚'
  ]},
  {t:'edge', cn:'è¾¹ç¼˜ï¼›ä¼˜åŠ¿', ex:[
    'Living at the edge of town, she struggle to keep appointments and consult native teachers.',
    'ä½åœ¨åŸè¾¹ï¼Œå¥¹å¾ˆéš¾æŒ‰æ—¶èµ´çº¦å¹¶å‘æœ¬åœ°è€å¸ˆè¯·æ•™ã€‚'
  ]},
  {t:'appointment', cn:'é¢„çº¦ï¼›ä»»å‘½', ex:[
    'Your appointment will require a presentation; please attach slides and confirm the time.',
    'ä½ çš„é¢„çº¦éœ€è¦è¿›è¡Œæ±‡æŠ¥ï¼›è¯·é™„ä¸Šå¹»ç¯å¹¶ç¡®è®¤æ—¶é—´ã€‚'
  ]},
  {t:'assess', cn:'è¯„ä¼°', ex:[
    'We assess the contrast between response and content to evaluate whether the proposal makes sense.',
    'æˆ‘ä»¬è¯„ä¼°â€œåé¦ˆâ€å’Œâ€œå†…å®¹â€çš„å·®å¼‚ï¼Œä»¥åˆ¤æ–­ææ¡ˆæ˜¯å¦åˆç†ã€‚'
  ]},
  {t:'concentrate', cn:'ä¸“æ³¨ï¼›é›†ä¸­', ex:[
    'Concentrate during the drill; besides, observe exits and confirm your position with the assistant.',
    'æ¼”ç»ƒæ—¶è¯·ä¸“æ³¨ï¼›æ­¤å¤–ï¼Œè¯·è§‚å¯Ÿå‡ºå£å¹¶å‘åŠ©ç†ç¡®è®¤ä½ çš„ä½ç½®ã€‚'
  ]},
  {t:'particular', cn:'ç‰¹å®šçš„ï¼›ç‰¹åˆ«çš„', ex:[
    'In this particular setting, we assign roles, measure progress, and prevent scope creep.',
    'åœ¨è¿™ä¸ªç‰¹å®šæƒ…å¢ƒä¸‹ï¼Œæˆ‘ä»¬åˆ†é…è§’è‰²ã€åº¦é‡è¿›åº¦ï¼Œå¹¶é˜²æ­¢èŒƒå›´è†¨èƒ€ã€‚'
  ]},
];


/* æ„å»º deckOrderï¼ˆ9è¯ä¸€å›åˆï¼‰ï¼ŒæŒ‰ä¸Šé¢é¡ºåºå³å¯ */
const deckOrder = base.map(b=>b.t);



/* â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ ç´¢å¼•&çŠ¶æ€ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
const map = new Map(base.map((b,i)=>[b.t,i]));
const deck = deckOrder.map(t=>base[map.get(t)]).filter(Boolean);
let currentRound = 0; // ä»0èµ·
const pageSize = 9;
let inSentencesView = false;
let scrambled = false;
let wrongBook = new Set(JSON.parse(localStorage.getItem('wrongBook_v1')||'[]'));

/* â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ å·¥å…· â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
function speak(text, lang='en-US'){
  try{
    const u = new SpeechSynthesisUtterance(text);
    const voices = speechSynthesis.getVoices();
    const en = voices.find(v=>/en[-_](US|GB)|English/i.test(v.lang)) || voices[0];
    if(en) u.voice = en; u.lang = en?.lang || lang; u.rate = 0.95; u.pitch = 1; u.volume = 1;
    speechSynthesis.cancel();
    speechSynthesis.speak(u);
  }catch(e){console.warn('TTS failed:',e)}
}
function saveWrong(){ localStorage.setItem('wrongBook_v1', JSON.stringify([...wrongBook])); }
function chunk(arr, size){ const out=[]; for(let i=0;i<arr.length;i+=size) out.push(arr.slice(i,i+size)); return out; }
function randPick(arr, k){ const a=[...arr]; a.sort(()=>Math.random()-0.5); return a.slice(0, k); }
function setBar(){
  const total = inWrongMode ? getWrongDeck().length : deck.length;
  if(total <= 0){ document.getElementById('bar').style.width = '0%'; return; }
  const totalRounds = Math.max(1, Math.ceil(total/pageSize));
  const pct = ((currentRound) / (totalRounds-1 || 1)) * 100;
  document.getElementById('bar').style.width = pct + '%';
}

/* â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ æ¸²æŸ“ï¼šè¯å¡é¡µ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
function renderWords(){
  inSentencesView = false;
  document.getElementById('wordsView').style.display='block';
  document.getElementById('sentencesView').style.display='none';
  document.getElementById('toggleViewBtn').textContent='åˆ‡æ¢åˆ°ä¾‹å¥é¡µ';

  const arr = inWrongMode ? getWrongDeck() : deck;
  const rounds = chunk(arr, pageSize);
  const totalRounds = rounds.length;
  currentRound = Math.max(0, Math.min(currentRound, Math.max(0,totalRounds-1)));
  const round = rounds[currentRound] || [];
  const g = document.getElementById('grid');
  g.innerHTML='';

  if(inWrongMode && arr.length===0){
    g.innerHTML = '<div class="card" style="border-style:dashed;opacity:.9"><div class="term">é”™é¢˜æœ¬æ˜¯ç©ºçš„</div><div class="meta">åœ¨è¯å¡é¡µç‚¹å‡»ğŸ“ŒåŠ å…¥åå†æ¥å¤ä¹ </div></div>';
    document.getElementById('roundIdx').textContent = 0;
    document.getElementById('roundTotal').textContent = 0;
    document.getElementById('roundCount').textContent = 0;
    setBar();
    return;
  }

  round.forEach(item=>{
    const card = document.createElement('div');
    card.className='card';

    const tb = document.createElement('div');
    tb.className='toolbar';

    const exBtn = document.createElement('button');
    exBtn.className='iconbtn'; exBtn.title='ä¾‹å¥'; exBtn.innerHTML='ğŸ’¬';
    exBtn.onclick = ()=>openExample(item);

    const pin = document.createElement('button');
    pin.className='iconbtn'; pin.title='åŠ å…¥/ç§»å‡ºé”™é¢˜æœ¬'; pin.innerHTML='ğŸ“Œ';
    if(wrongBook.has(item.t)) pin.classList.add('active');
    pin.onclick = ()=>{ if(wrongBook.has(item.t)) wrongBook.delete(item.t); else wrongBook.add(item.t); pin.classList.toggle('active'); saveWrong(); updateFooter(); };

    tb.appendChild(exBtn); tb.appendChild(pin);

    const term = document.createElement('div');
    term.className='term'; term.textContent = item.t;
    term.setAttribute('role','button');
    term.onclick = ()=>{ speak(item.t); cn.classList.toggle('show'); maybeSurprise(); };

    const cn = document.createElement('div');
    cn.className='cn'; cn.textContent = item.cn;

    const meta = document.createElement('div');
    meta.className='meta'; meta.textContent='ç‚¹å‡»å•è¯ï¼šå‘éŸ³ + æ˜¾ç¤ºä¸­æ–‡';

    card.appendChild(tb);
    card.appendChild(term);
    card.appendChild(cn);
    card.appendChild(meta);
    g.appendChild(card);
  });

  // è¡¥ä½ï¼ˆä¸è¶³9ä¸ªï¼‰
  const remain = pageSize - round.length;
  for(let i=0;i<remain;i++){
    const ghost = document.createElement('div');
    ghost.className='card';
    ghost.style.opacity=.5; ghost.style.borderStyle='dashed';
    ghost.innerHTML='<div class="meta">ï¼ˆæœ¬å›åˆä¸è¶³ä¹ä¸ªï¼‰</div>';
    g.appendChild(ghost);
  }

  document.getElementById('roundIdx').textContent = (currentRound+1);
  document.getElementById('roundTotal').textContent = totalRounds;
  document.getElementById('roundCount').textContent = round.length;
  setBar();
}

/* â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ æ¸²æŸ“ï¼šä¾‹å¥é¡µï¼ˆæœ¬å›åˆéšæœº2~3å¥ï¼‰ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
function renderSentences(){
  inSentencesView = true;
  document.getElementById('wordsView').style.display='none';
  document.getElementById('sentencesView').style.display='block';
  document.getElementById('toggleViewBtn').textContent='åˆ‡æ¢åˆ°è¯å¡é¡µ';

  const arr = inWrongMode ? getWrongDeck() : deck;
  const rounds = chunk(arr, pageSize);
  const round = rounds[currentRound] || [];
  const box = document.getElementById('sentences');
  box.innerHTML='';

  if(inWrongMode && arr.length===0){
    const s = document.createElement('div'); s.className='sentence';
    s.innerHTML = '<div class="en">é”™é¢˜æœ¬æš‚æ— ä¾‹å¥</div><div class="zh show">å…ˆå›åˆ°è¯åº“é¡µæ·»åŠ ä¸€äº›ğŸ“Œå§</div>';
    box.appendChild(s);
    return;
  }

  const k = Math.min(3, Math.max(2, Math.floor(Math.random()*2)+2));
  const pick = randPick(round, Math.min(k, round.length));

  pick.forEach(item=>{



    const s = document.createElement('div'); s.className='sentence';
    const en = document.createElement('div'); en.className='en'; en.textContent=item.ex[0];
    const zh = document.createElement('div'); zh.className='zh'; zh.textContent=item.ex[1];
    s.appendChild(en); s.appendChild(zh);
    s.onclick=()=> zh.classList.toggle('show');
    box.appendChild(s);
  });
}

/* â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ ä¾‹å¥å¼¹çª— â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
function openExample(item){


  document.getElementById('exTitle').textContent = `ğŸ“˜ ${item.t}`;
  const c = document.getElementById('exContent');
  c.innerHTML = '';
  const en = document.createElement('div'); en.className='en'; en.textContent=item.ex[0];
  const zh = document.createElement('div'); zh.className='zh show'; zh.textContent=item.ex[1];
  const p = document.createElement('div'); p.className='hint'; p.textContent='ç‚¹å‡»è‹±æ–‡å‘éŸ³';
  en.onclick=()=>speak(item.ex[0]);
  c.appendChild(en); c.appendChild(zh); c.appendChild(p);
  document.getElementById('exampleModal').classList.add('show');
}

/* â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ è¿·ä½ ç¿»è¯‘æŒ‘æˆ˜ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
let quizItem = null;
function openQuiz(fromWrong=false, promptText='ğŸ¯ ç¿»è¯‘æŒ‘æˆ˜ï¼ˆè¾“å…¥ä¸­æ–‡ä¹‰ï¼‰'){
  const rounds = chunk(deck, pageSize);
  const round = inWrongMode? chunk(getWrongDeck(), pageSize)[currentRound] || [] : rounds[currentRound] || [];
  const pool = fromWrong ? getWrongDeck() : (round.length? round : deck);
  if(pool.length===0){ alert('æœ¬å›åˆæš‚æ— è¯æ¡'); return; }
  quizItem = pool[Math.floor(Math.random()*pool.length)];
  document.getElementById('quizTitle').textContent = promptText;

  const wrap = document.getElementById('quizWrap');
  wrap.innerHTML = '';

  const q = document.createElement('div'); q.className='en'; q.style.marginBottom='8px'; q.textContent = `è¯·ç¿»è¯‘ï¼š${quizItem.t}`;
  const input = document.createElement('input'); input.placeholder='è¾“å…¥ä¸­æ–‡æ„æ€'; input.style.width='100%'; input.style.padding='10px'; input.style.borderRadius='10px'; input.style.border='1px solid var(--stroke)'; input.style.background='rgba(255,255,255,.9)'; input.style.color='var(--txt)';
  const bar = document.createElement('div'); bar.style.display='flex'; bar.style.gap='8px'; bar.style.marginTop='10px';
  const btn = document.createElement('button'); btn.className='btn primary'; btn.textContent='æäº¤';
  const reveal = document.createElement('button'); reveal.className='btn'; reveal.textContent='æ˜¾ç¤ºç­”æ¡ˆ';
  const addWrong = document.createElement('button'); addWrong.className='btn'; addWrong.textContent='åŠ å…¥é”™é¢˜æœ¬ ğŸ“Œ';
  bar.appendChild(btn); bar.appendChild(reveal); bar.appendChild(addWrong);
  const res = document.createElement('div'); res.className='hint'; res.style.marginTop='8px';

  btn.onclick = ()=>{
    const user = (input.value||'').trim();
    if(!user){ res.textContent='å…ˆè¾“å…¥ä½ çš„ç¿»è¯‘~'; return; }
    const ans = quizItem.cn.replace(/[ï¼›;ï¼Œ,ã€‚]/g,' ');
    let ok=false;
    const parts = ans.split(/\s+/).filter(Boolean);
    for(const p of parts){ if(p && user.includes(p)) { ok=true; break; } }
    if(ok){ res.textContent='âœ… ä¸é”™ï¼'; confetti(); }
    else { res.textContent='âŒ å†æƒ³æƒ³ã€‚æ­£ç¡®ç­”æ¡ˆï¼š'+quizItem.cn; }
  };
  reveal.onclick = ()=>{ res.textContent='ç­”æ¡ˆï¼š'+quizItem.cn; };
  addWrong.onclick = ()=>{ wrongBook.add(quizItem.t); saveWrong(); updateFooter(); addWrong.classList.add('active'); };

  wrap.appendChild(q); wrap.appendChild(input); wrap.appendChild(bar); wrap.appendChild(res);
  document.getElementById('quizModal').classList.add('show');
}

/* â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ é”™é¢˜æœ¬è§†å›¾ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
let inWrongMode = false;
function getWrongDeck(){ return [...wrongBook].map(t=> base[map.get(t)]).filter(Boolean); }
function enterWrong(){ inWrongMode = true; document.getElementById('deckTabBtn').style.display='inline-flex'; document.getElementById('wrongTabBtn').style.display='none'; currentRound=0; renderWords(); updateFooter(); }
function leaveWrong(){ inWrongMode = false; document.getElementById('deckTabBtn').style.display='none'; document.getElementById('wrongTabBtn').style.display='inline-flex'; currentRound=0; renderWords(); updateFooter(); }

/* â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ æ˜¾ç¤º/éšè— & éšæœº â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
function showAllCN(){ document.querySelectorAll('#grid .cn').forEach(el=>el.classList.add('show')); }
function hideAllCN(){ document.querySelectorAll('#grid .cn').forEach(el=>el.classList.remove('show')); }
function showAllZh(){ document.querySelectorAll('#sentences .zh').forEach(el=>el.classList.add('show')); }
function hideAllZh(){ document.querySelectorAll('#sentences .zh').forEach(el=>el.classList.remove('show')); }

function updateFooter(){
  const total = inWrongMode ? getWrongDeck().length : deck.length;
  let rounds = Math.ceil(total/pageSize);
  const wrongCount = wrongBook.size; document.getElementById('wrongCount').textContent = wrongCount;

  if(inWrongMode && total===0){
    document.getElementById('roundTotal').textContent = 0;
    document.getElementById('roundIdx').textContent = 0;
    document.getElementById('roundCount').textContent = 0;
    setBar();
    return;
  }

  rounds = Math.max(1, rounds);
  document.getElementById('roundTotal').textContent = rounds;
  const roundArr = inWrongMode ? chunk(getWrongDeck(), pageSize)[currentRound] || [] : chunk(deck, pageSize)[currentRound] || [];
  document.getElementById('roundCount').textContent = roundArr.length;
  document.getElementById('roundIdx').textContent = (currentRound+1);
  setBar();
}

function prevRound(){ if(currentRound>0){ currentRound--; renderCurrent(); } }
function nextRound(){
  const total = inWrongMode ? getWrongDeck().length : deck.length;
  const rounds = Math.ceil(total/pageSize);
  if(currentRound < rounds-1){ currentRound++; renderCurrent(); }
}
function renderCurrent(){ if(inSentencesView) renderSentences(); else renderWords(); updateFooter(); maybeSurprise(); }
function toggleView(){ inSentencesView? renderWords() : renderSentences(); maybeSurprise(); }

function shuffleDeck(){
  scrambled = !scrambled;
  const arr = inWrongMode ? getWrongDeck() : deck;
  if(scrambled){ arr.sort(()=>Math.random()-0.5); } else {
    if(inWrongMode){ /* é”™é¢˜æœ¬æ— åŸé¡ºåºï¼Œå¿½ç•¥ */ }
    else {
      while(deck.length) deck.pop();
      deckOrder.forEach(t=> deck.push(base[map.get(t)]));
    }
  }
  currentRound=0; renderCurrent();
}

/* â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ å°æƒŠå–œï¼ˆå½©çº¸ï¼‰ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
function confetti(){
  const b = document.getElementById('burst');
  for(let i=0;i<32;i++){
    const p=document.createElement('div'); p.className='piece';
    const x = (window.innerWidth/2)+'px'; const y = '20%';
    const x2 = (Math.random()*100)+'vw'; const y2 = (60+Math.random()*40)+'vh';
    p.style.setProperty('--x', x); p.style.setProperty('--y', y); p.style.setProperty('--x2', x2); p.style.setProperty('--y2', y2);
    p.style.background = `linear-gradient(${Math.random()*360}deg, var(--accent), var(--accent2))`;
    p.style.left = (window.innerWidth/2)+'px'; p.style.top='10%';
    b.appendChild(p); setTimeout(()=>p.remove(), 1000);
  }
}
let titleTap=0; document.getElementById('title').addEventListener('click',()=>{ titleTap++; if(titleTap>=3){ confetti(); titleTap=0; }});

/* â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ å¶é‡æµ‹éªŒï¼ˆéšæœºå¼¹å‡ºé”™é¢˜æé†’ï¼‰ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
   è§¦å‘æ—¶æœºï¼šåˆ‡æ¢å›åˆ/è§†å›¾ã€ç‚¹å‡»è¯æ¡æ—¶ï¼Œæœ‰ä¸€å®šæ¦‚ç‡ä»ã€é”™é¢˜æœ¬ã€‘æŠ½ä¸€é“ï¼›
   è¡¨ç°ï¼šç”¨å…±ç”¨çš„ quizModalï¼Œæ ‡é¢˜æ”¹ä¸ºâ€œä½ è¿˜æ²¡èƒŒè¿‡æˆ‘~â€
*/
let surpriseCooldown = false;
function maybeSurprise(){
  // å¦‚æœè¿˜åœ¨å†·å´æˆ–é”™é¢˜æœ¬ä¸ºç©ºå°±ä¸è§¦å‘
  if(surpriseCooldown) return;
  if(wrongBook.size === 0) return;

  const p = inSentencesView ? 0.12 : 0.18; // è§¦å‘æ¦‚ç‡ï¼šä¾‹å¥é¡µä½ä¸€ç‚¹ï¼Œè¯å¡é¡µé«˜ä¸€ç‚¹
  if(Math.random() < p){
    surpriseCooldown = true;

    // ä¸€åŠæ¦‚ç‡ç›´æ¥å‡ºâ€œçŒœä¸­æ–‡ä¹‰â€çš„ quizï¼ˆä»é”™é¢˜æœ¬æŠ½ï¼‰
    if(Math.random() < 0.5){
      openQuiz(true, 'ğŸ«£ ä½ è¿˜æ²¡èƒŒè¿‡æˆ‘â€”â€”å†çŒœçŒœæˆ‘çš„æ„æ€å§');
    } else {
      // å¦ä¸€åŠæ¦‚ç‡åœ¨ä¾‹å¥å¼¹çª—å±•ç¤ºã€é”™é¢˜æœ¬é‡Œçš„æ¡ç›®ã€‘ï¼Œä½†**ä¸å†ç”Ÿæˆä¾‹å¥**ï¼Œç›´æ¥ä½¿ç”¨ item.ex
      const pool = getWrongDeck();
      const item = pool[(Math.random() * pool.length) | 0];

      // å¦‚æœé€‰ä¸­çš„æ¡ç›®ä¸å­˜åœ¨æˆ–è€…æ²¡æœ‰ ex å­—æ®µï¼Œé™çº§ä¸º quizï¼ˆé¿å…æŠ¥é”™ï¼‰
      if(!item || !item.ex || !item.ex[0]){
        // ä¼˜å…ˆä½¿ç”¨è¯¥æ¡ç›®çš„ quizï¼ˆè‹¥ item å­˜åœ¨ï¼‰ï¼Œå¦åˆ™éšæœº quiz
        if(item) openQuiz(true, 'ğŸ«£ ä½ è¿˜æ²¡èƒŒè¿‡æˆ‘â€”â€”å†çŒœçŒœæˆ‘çš„æ„æ€å§');
        else openQuiz(false, 'ğŸ«£ ä½ è¿˜æ²¡èƒŒè¿‡æˆ‘â€”â€”å†çŒœçŒœæˆ‘çš„æ„æ€å§');
      } else {
        // ç›´æ¥ç”¨ item.exï¼ˆä¸ç”Ÿæˆã€ä¸è¦†ç›–ï¼‰
        document.getElementById('exTitle').textContent = `ğŸ«£ ä½ è¿˜æ²¡èƒŒè¿‡æˆ‘ï¼š${item.t}`;
        const c = document.getElementById('exContent');
        c.innerHTML = '';

        const tip = document.createElement('div'); tip.className = 'hint';
        tip.textContent = 'ç‚¹è‹±æ–‡å¯å‘éŸ³ï¼Œç‚¹è¯‘æ–‡å¯æ˜¾ç¤º/éšè—';

        const en = document.createElement('div'); en.className = 'en';
        en.textContent = item.ex[0];
        en.onclick = () => speak(item.ex[0]);

        // ä¸­æ–‡é»˜è®¤éšè—ï¼Œç‚¹å¼€æ‰æ˜¾ç¤ºï¼ˆé¼“åŠ±å…ˆçŒœï¼‰
        const zh = document.createElement('div'); zh.className = 'zh';
        zh.textContent = (item.ex[1] && item.ex[1].length) ? item.ex[1] : 'ï¼ˆè¯‘æ–‡æš‚ç¼ºï¼Œå…ˆè‡ªå·±çŒœçŒœï¼‰';
        // ä¸è‡ªåŠ¨å±•å¼€ï¼Œç”¨æˆ·ç‚¹è‹±æ–‡æˆ–ç‚¹è¯‘æ–‡æ—¶å¯ä»¥æŸ¥çœ‹

        c.appendChild(tip);
        c.appendChild(en);
        c.appendChild(zh);
        document.getElementById('exampleModal').classList.add('show');
      }
    }

    // å†·å´ 20 ç§’ï¼Œé¿å…é¢‘ç¹å¼¹çª—ï¼Œéœ€æŒ‰éœ€è°ƒæ•´
    setTimeout(()=>{ surpriseCooldown = false; }, 20000);
  }
}


/* â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ äº‹ä»¶ç»‘å®š â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
window.addEventListener('load', ()=>{ renderWords(); updateFooter(); setTimeout(()=>speechSynthesis.getVoices(), 300); });

document.getElementById('prevBtn').onclick = ()=>{ prevRound(); };
document.getElementById('nextBtn').onclick = ()=>{ nextRound(); };
document.getElementById('toggleViewBtn').onclick = ()=>{ toggleView(); };
document.getElementById('showAllBtn').onclick = showAllCN;
document.getElementById('hideAllBtn').onclick = hideAllCN;
document.getElementById('shuffleBtn').onclick = ()=>{ shuffleDeck(); };
document.getElementById('wrongTabBtn').onclick = ()=>{ enterWrong(); };
document.getElementById('deckTabBtn').onclick = ()=>{ leaveWrong(); };
document.getElementById('miniGameBtn').onclick = ()=>{ openQuiz(false, 'ğŸ¯ ç¿»è¯‘æŒ‘æˆ˜ï¼ˆè¾“å…¥ä¸­æ–‡ä¹‰ï¼‰'); };
document.getElementById('eggBtn').onclick = confetti;

document.getElementById('shuffleSentBtn').onclick = ()=>{ renderSentences(); };
document.getElementById('showAllZhSent').onclick = showAllZh;
document.getElementById('hideAllZhSent').onclick = hideAllZh;

document.getElementById('closeEx').onclick = ()=>document.getElementById('exampleModal').classList.remove('show');
document.getElementById('exampleModal').addEventListener('click', e=>{ if(e.target.id==='exampleModal') e.currentTarget.classList.remove('show'); });

document.getElementById('closeQuiz').onclick = ()=>document.getElementById('quizModal').classList.remove('show');
document.getElementById('quizModal').addEventListener('click', e=>{ if(e.target.id==='quizModal') e.currentTarget.classList.remove('show'); });
</script>
</body>
</html>
